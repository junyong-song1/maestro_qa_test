appId: net.cj.cjhv.gs.tving
---
# 클립 풀 플레이어 재생
# TestRail Case ID: 313890
# https://tving.testrail.io/index.php?/cases/view/313890
#- launchApp
# 로그인 체크 및 처리
#- launchApp
- runFlow:
    when:
      visible:
        text: "티빙 로그인"
    commands:
      - tapOn:
          text: "티빙 로그인"
      - runFlow: sub_flows/login_flow.yaml
      - tapOn:
          text: "뉴스"

- runFlow:
    when:
      notVisible:
        text: "티빙 로그인"
    commands:
      - tapOn:
          id: "net.cj.cjhv.gs.tving:id/image_close"
          optional: true
      - tapOn:
          text: "뉴스"

# 썸네일 클릭
- tapOn:
    id: "net.cj.cjhv.gs.tving:id/iv_thumbnail"
    index: 0

# 화면 회전 처리
- repeat:
    while:
      notVisible:
        text: "화면 회전"
    times: 5
    commands:
      - tapOn:
          id: net.cj.cjhv.gs.tving:id/player_container
      - tapOn:
         above:
            id: net.cj.cjhv.gs.tving:id/controller_compose  
         containsDescendants:                       # matches a view that has all the descendant views given below
           - text: "화면 회전"
# JavaScript 실행 및 검증
- evalScript: |
    const fs = require('fs');
    if (!fs.existsync('result/playing_check.txt')) {
     throw new Error('playing_check.txt 파일이 존재하지 않습니다.');
    }
    const log = fs.readFileSync('result/playing_check.txt', 'utf-8').trim();
    output.jsLogValue = log;
    assertEqual:
      actual: ${output.jsLogValue}
      expected: "OK"